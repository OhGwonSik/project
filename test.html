<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>날씨</title>
    <!-- jquery CDN 불러오기 -->
    <script src="https://code.jquery.com/jquery-3.6.1.js" integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>    
    <script src="https://kit.fontawesome.com/82511618be.js" crossorigin="anonymous"></script>
<style>
    *{
        margin: 0;
        padding: 0;
    }
    .wrap{
        background-color : rgb(101, 178, 255);
        padding : 40px;
        color : #fff;
        height : 150px;
        width : 500px;
    }
    .icon_wrap{
        float : left;
    }
    .menu{
        float : right;
        margin : -5px 0px 0px 60px;
        font-size : 11pt;
    }
    .tempzone{
        float : left;
        margin-top : -30px
    }
    .current_temp{
        font-size : 50pt
    }
    .weather_description{
        font-size : 13pt
    }
    .city{
        left: 50px;
        font-size : 13pt
    }
</style>
</head>
<script>
    //description 한글화
var weatherDescKo = [
  { 201: '가벼운 비를 동반한 천둥구름' },
  { 200: '비를 동반한 천둥구름' },
  { 202: '폭우를 동반한 천둥구름' },
  { 210: '약한 천둥구름' },
  { 211: '천둥구름' },
  { 212: '강한 천둥구름' },
  { 221: '불규칙적 천둥구름' },
  { 230: '약한 연무를 동반한 천둥구름' },
  { 231: '연무를 동반한 천둥구름' },
  { 232: '강한 안개비를 동반한 천둥구름' },
  { 300: '가벼운 안개비' },
  { 301: '안개비' },
  { 302: '강한 안개비' },
  { 310: '가벼운 적은비' },
  { 311: '적은비' },
  { 312: '강한 적은비' },
  { 313: '소나기와 안개비' },
  { 314: '강한 소나기와 안개비' },
  { 321: '소나기' },
  { 500: '악한 비' },
  { 501: '중간 비' },
  { 502: '강한 비' },
  { 503: '매우 강한 비' },
  { 504: '극심한 비' },
  { 511: '우박' },
  { 520: '약한 소나기 비' },
  { 521: '소나기 비' },
  { 522: '강한 소나기 비' },
  { 531: '불규칙적 소나기 비' },
  { 600: '가벼운 눈' },
  { 601: '눈' },
  { 602: '강한 눈' },
  { 611: '진눈깨비' },
  { 612: '소나기 진눈깨비' },
  { 615: '약한 비와 눈' },
  { 616: '비와 눈' },
  { 620: '약한 소나기 눈' },
  { 621: '소나기 눈' },
  { 622: '강한 소나기 눈' },
  { 701: '박무' },
  { 711: '연기' },
  { 721: '연무' },
  { 731: '모래 먼지' },
  { 741: '안개' },
  { 751: '모래' },
  { 761: '먼지' },
  { 762: '화산재' },
  { 771: '돌풍' },
  { 781: '토네이도' },
  { 800: '구름 한 점 없는 맑은 하늘' },
  { 801: '약간의 구름이 낀 하늘' },
  { 802: '드문드문 구름이 낀 하늘' },
  { 803: '구름이 거의 없는 하늘' },
  { 804: '구름으로 뒤덮인 흐린 하늘' },
  { 900: '토네이도' },
  { 901: '태풍' },
  { 902: '허리케인' },
  { 903: '한랭' },
  { 904: '고온' },
  { 905: '바람부는' },
  { 906: '우박' },
  { 951: '바람이 거의 없는' },
  { 952: '약한 바람' },
  { 953: '부드러운 바람' },
  { 954: '중간 세기 바람' },
  { 955: '신선한 바람' },
  { 956: '센 바람' },
  { 957: '돌풍에 가까운 센 바람' },
  { 958: '돌풍' },
  { 959: '심각한 돌풍' },
  { 960: '폭풍' },
  { 961: '강한 폭풍' },
  { 962: '허리케인' },
]
    //fontawesome 아이콘
    var weatherIcon = {
    '01' : 'fas fa-sun',
    '02' : 'fas fa-cloud-sun',
    '03' : 'fas fa-cloud',
    '04' : 'fas fa-cloud-meatball',
    '09' : 'fas fa-cloud-sun-rain',
    '10' : 'fas fa-cloud-showers-heavy',
    '11' : 'fas fa-poo-storm',
    '13' : 'far fa-snowflake',
    '50' : 'fas fa-smog'
};

    //ajax로 api통신하기 서울 lat=37.5666791 lon=126.9782914 &lang=kr
    // 키 = 5b564245bfc71db473fd8f9dbc250539
    $.ajax({
        method: "GET",
        url: "https://api.openweathermap.org/data/2.5/weather?q=Yangju&units=metric&appid=5b564245bfc71db473fd8f9dbc250539",
        data: {}
    })
    //통신 성공 했을 때
    .done(function(data) {
        console.log(data);
        var $Icon = (data.weather[0].icon).substr(0,2);
        var $weather_description = data.weather[0].id;
        var $Temp = Math.floor(data.main.temp) + 'º';
        var $humidity = '습도&nbsp;&nbsp;&nbsp;&nbsp;' + data.main.humidity + ' %';
        var $wind = '바람&nbsp;&nbsp;&nbsp;&nbsp;' + data.wind.speed + ' m/s';
        var $city = data.name;
        var $cloud = '구름&nbsp;&nbsp;&nbsp;&nbsp;' + data.clouds.all +"%";
        // var $temp_min = '최저 온도&nbsp;&nbsp;&nbsp;&nbsp;' + Math.floor(tmpMin) + 'º';
        var $temp_max = '최고 온도&nbsp;&nbsp;&nbsp;&nbsp;' + Math.floor(data.main.temp_max) + 'º';
        var $feel = '체감 온도&nbsp;&nbsp;&nbsp;&nbsp;' + Math.floor(data.main.feels_like) + 'º';

        $('.weather_icon').append('<i class="' + weatherIcon[$Icon] +' fa-5x" style="height : 150px; width : 150px;"></i>');
        // $('.weather_description').prepend($weather_description);
        $('.current_temp').prepend($Temp);
        $('.humidity').prepend($humidity);
        $('.wind').prepend($wind);
        $('.city').append($city);
        $('.cloud').append($cloud);
        // $('.temp_min').append($temp_min);
        $('.temp_max').append($temp_max);         
        $('.feel').append($feel);
        //weatherDescKo의 키 비교 후 값을 가져오는 알고리즘
        for(var i=0;i<$weather_description;i++){
            if($weather_description==Object.keys(weatherDescKo[i])){
            $('.weather_description').prepend(weatherDescKo[i][$weather_description]);
        }else{
            console.log("false")
        }
        }   
    });
    //서울
    
    
</script>
<body>
    <div class = "wrap">
        <div class = "icon_wrap">
            <div class="weather_icon"></div>
        </div><br>
    
        <div class = "menu">
                <div class="temp_min"></div>
                <div class="temp_max"></div>
                <div class="feel"></div>
                <div class="humidity"></div>
                <div class="wind"></div>
                <div class="cloud"></div>
        </div>
        <div class ="tempzone">
            <div class="current_temp"></div>
            <div class="weather_description"></div>
            <div class="city"></div>
        </div>
    </div>
</body>
</html>